<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2203.125px" preserveAspectRatio="none" style="width:847px;height:2203px;" version="1.1" viewBox="0 0 847 2203" width="847.9167px" zoomAndPan="magnify"><defs><linearGradient id="g11uczrgpomi10" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#CCCCCC"/></linearGradient><linearGradient id="g11uczrgpomi11" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#F08E41"/><stop offset="100%" stop-color="#EC7211"/></linearGradient></defs><g><rect fill="url(#g11uczrgpomi10)" height="45.0846" id="_title" rx="4.1667" ry="4.1667" style="stroke:#FFFFFF;stroke-width:1.0416666666666667;" width="215.625" x="311.9792" y="10.4167"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="20.8333" font-weight="bold" lengthAdjust="spacing" textLength="194.7917" x="322.3958" y="40.1713">H4X Challenge 1</text><rect fill="#BCC5CE" height="647.0052" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="254.6875" y="220.0195"/><rect fill="#BCC5CE" height="958.0404" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="254.6875" y="1143.8802"/><rect fill="#BCC5CE" height="14.5833" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="495.3125" y="220.0195"/><rect fill="#BCC5CE" height="85.3516" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="495.3125" y="781.6732"/><rect fill="#BCC5CE" height="39.5508" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="495.3125" y="1143.8802"/><rect fill="#BCC5CE" height="143.5547" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="654.1667" y="480.013"/><rect fill="#BCC5CE" height="632.4544" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="654.1667" y="1326.9857"/><rect fill="none" height="193.5547" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="702.0833" x="128.125" y="936.7839"/><rect fill="none" height="300.5534" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="335.4167" x="491.6667" y="1432.0638"/><rect fill="none" height="173.7305" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="290.625" x="513.5417" y="1747.2005"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="259.375" x2="259.375" y1="149.2188" y2="2111.2956"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="500" x2="500" y1="149.2188" y2="2111.2956"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="659.375" x2="659.375" y1="149.2188" y2="2111.2956"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="241.6667" y="141.0624">User</text><ellipse cx="259.8958" cy="70.6055" fill="url(#g11uczrgpomi11)" rx="8.3333" ry="8.3333" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><path d="M259.8958,78.9388 L259.8958,107.0638 M246.3542,87.2721 L273.4375,87.2721 M259.8958,107.0638 L246.3542,122.6888 M259.8958,107.0638 L273.4375,122.6888 " fill="none" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="241.6667" y="2127.065">User</text><ellipse cx="259.8958" cy="2144.0755" fill="url(#g11uczrgpomi11)" rx="8.3333" ry="8.3333" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><path d="M259.8958,2152.4089 L259.8958,2180.5339 M246.3542,2160.7422 L273.4375,2160.7422 M259.8958,2180.5339 L246.3542,2196.1589 M259.8958,2180.5339 L273.4375,2196.1589 " fill="none" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><rect fill="url(#g11uczrgpomi11)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="59.375" x="470.8333" y="108.6263"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="34.375" x="483.3333" y="132.7291">WWW</text><rect fill="url(#g11uczrgpomi11)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="59.375" x="470.8333" y="2110.2539"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="34.375" x="483.3333" y="2134.3567">WWW</text><rect fill="url(#g11uczrgpomi11)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="66.6667" x="628.125" y="104.4596"/><rect fill="url(#g11uczrgpomi11)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="66.6667" x="623.9583" y="108.6263"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="41.6667" x="636.4583" y="132.7291">Nodes</text><rect fill="url(#g11uczrgpomi11)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="66.6667" x="628.125" y="2110.2539"/><rect fill="url(#g11uczrgpomi11)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="66.6667" x="623.9583" y="2114.4206"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="41.6667" x="636.4583" y="2138.5234">Nodes</text><rect fill="#BCC5CE" height="647.0052" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="254.6875" y="220.0195"/><rect fill="#BCC5CE" height="958.0404" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="254.6875" y="1143.8802"/><rect fill="#BCC5CE" height="14.5833" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="495.3125" y="220.0195"/><rect fill="#BCC5CE" height="85.3516" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="495.3125" y="781.6732"/><rect fill="#BCC5CE" height="39.5508" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="495.3125" y="1143.8802"/><rect fill="#BCC5CE" height="143.5547" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="654.1667" y="480.013"/><rect fill="#BCC5CE" height="632.4544" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="654.1667" y="1326.9857"/><rect fill="#4E5D6C" height="3.125" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" width="840.625" x="0" y="185.6608"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="840.625" y1="185.6608" y2="185.6608"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="840.625" y1="188.7858" y2="188.7858"/><rect fill="#4E5D6C" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:2.0833333333333335;" width="154.1667" x="343.2292" y="170.0521"/><text fill="#ABB6C2" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="125" x="354.6875" y="191.0299">Set up password</text><polygon fill="#EC7211" points="482.8125,215.8529,493.2292,220.0195,482.8125,224.1862,486.9792,220.0195" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="265.1042" x2="489.0625" y1="220.0195" y2="220.0195"/><polygon fill="#EC7211" points="276.5625,230.4362,266.1458,234.6029,276.5625,238.7695,272.3958,234.6029" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="270.3125" x2="499.4792" y1="234.6029" y2="234.6029"/><path d="M102.0833,252.3112 L102.0833,438.7695 A4.1667,4.1667 0 0 0 106.25,442.9362 L412.5,442.9362 A4.1667,4.1667 0 0 0 416.6667,438.7695 L416.6667,258.5612 L406.25,248.1445 L106.25,248.1445 A4.1667,4.1667 0 0 0 102.0833,252.3112 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M406.25,248.1445 L406.25,256.4779 A2.0833,2.0833 0 0 0 408.3333,258.5612 L416.6667,258.5612 L406.25,248.1445 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="223.9583" x="113.5417" y="270.164">password1 = GeneratePassword()</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="125" x="113.5417" y="284.7148">password2 = "AAA"</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="82.2917" x="113.5417" y="299.2655">r1 = random</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="82.2917" x="113.5417" y="313.8163">r2 = random</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="256.25" x="113.5417" y="328.3671">Hash and convert password to EC point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="62.5" x="113.5417" y="342.9179">gPass1 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="215.625" x="180.2083" y="342.9179">findGPoint(hash(password1))</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="62.5" x="113.5417" y="357.4687">gPass2 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="215.625" x="180.2083" y="357.4687">findGPoint(hash(password2))</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="215.625" x="113.5417" y="372.0194">"Hide" the points with a random"</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="87.5" x="113.5417" y="386.5702">gBlurPass1 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="81.25" x="205.2083" y="386.5702">gPass1 ⋅ r1</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="87.5" x="113.5417" y="401.121">gBlurPass2 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="81.25" x="205.2083" y="401.121">gPass2 ⋅ r2</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="138.5417" x="113.5417" y="415.6718">exposedFlag1 = True</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="143.75" x="113.5417" y="430.2226">exposedFlag1 = False</text><polygon fill="#EC7211" points="641.6667,475.8464,652.0833,480.013,641.6667,484.1797,645.8333,480.013" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="265.1042" x2="647.9167" y1="480.013" y2="480.013"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="285.4167" x="277.6042" y="469.7734">Setup(gBlurPass1,gBlurPass2,exposedFlag)</text><path d="M504.1667,497.7214 L504.1667,582.0964 A4.1667,4.1667 0 0 0 508.3333,586.263 L810.4167,586.263 A4.1667,4.1667 0 0 0 814.5833,582.0964 L814.5833,503.9714 L804.1667,493.5547 L508.3333,493.5547 A4.1667,4.1667 0 0 0 504.1667,497.7214 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M804.1667,493.5547 L804.1667,501.888 A2.0833,2.0833 0 0 0 806.25,503.9714 L814.5833,503.9714 L804.1667,493.5547 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="110.4167" x="515.625" y="515.5741">PRISMi = random</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="221.875" x="515.625" y="530.1249">Apply the PRF on the hidden point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="129.1667" x="515.625" y="544.6757">gBlurPassPRISM1i =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="144.7917" x="648.9583" y="544.6757">gBlurPass1 ⋅ PRISMi</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="129.1667" x="515.625" y="559.2265">gBlurPassPRISM2i =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="144.7917" x="648.9583" y="559.2265">gBlurPass2 ⋅ PRISMi</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="216.6667" x="515.625" y="573.7773">StoreLocally(PRISMi,exposedFlag)</text><polygon fill="#EC7211" points="276.5625,619.401,266.1458,623.5677,276.5625,627.7344,272.3958,623.5677" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="270.3125" x2="658.3333" y1="623.5677" y2="623.5677"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="241.6667" x="288.0208" y="613.328">gBlurPassPRISM1i , gBlurPassPRISM2i</text><path d="M5.2083,641.276 L5.2083,740.2344 A4.1667,4.1667 0 0 0 9.375,744.401 L511.4583,744.401 A4.1667,4.1667 0 0 0 515.625,740.2344 L515.625,647.526 L505.2083,637.1094 L9.375,637.1094 A4.1667,4.1667 0 0 0 5.2083,641.276 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M505.2083,637.1094 L505.2083,645.4427 A2.0833,2.0833 0 0 0 507.2917,647.526 L515.625,647.526 L505.2083,637.1094 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="101.0417" x="16.6667" y="659.1288">gPassPRISM1 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="254.1667" x="121.875" y="659.1288">∑ ( gBlurPassPRISM1i ) ⋅ modInv(r1)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="4.1667" x="376.0417" y="659.1288"> </text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="114.5833" x="380.2083" y="659.1288">( gPass1 ⋅ PRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="101.0417" x="16.6667" y="673.6796">gPassPRISM2 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="254.1667" x="121.875" y="673.6796">∑ ( gBlurPassPRISM2i ) ⋅ modInv(r2)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="4.1667" x="376.0417" y="673.6796"> </text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="114.5833" x="380.2083" y="673.6796">( gPass2 ⋅ PRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="225" x="16.6667" y="688.2304">PRISMKey1 = hash( gPassPRISM1 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="225" x="16.6667" y="702.7812">PRISMKey2 = hash( gPassPRISM1 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="430.2083" x="16.6667" y="717.3319">encMsg1 = aesEnc_PRISMKey1( "Congrats! Your prize is xxxxxxxx" )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="412.5" x="16.6667" y="731.8827">encMsg2 = aesEnc_PRISMKey2( "This is an example message" )</text><polygon fill="#EC7211" points="482.8125,777.5065,493.2292,781.6732,482.8125,785.8398,486.9792,781.6732" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="265.1042" x2="489.0625" y1="781.6732" y2="781.6732"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="200" x="277.6042" y="771.4335">StoreMsgs(encMsg1,encMsg2)</text><path d="M379.1667,799.3815 L379.1667,825.4232 A4.1667,4.1667 0 0 0 383.3333,829.5898 L616.6667,829.5898 A4.1667,4.1667 0 0 0 620.8333,825.4232 L620.8333,805.6315 L610.4167,795.2148 L383.3333,795.2148 A4.1667,4.1667 0 0 0 379.1667,799.3815 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M610.4167,795.2148 L610.4167,803.5482 A2.0833,2.0833 0 0 0 612.5,805.6315 L620.8333,805.6315 L610.4167,795.2148 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="209.375" x="390.625" y="817.2343">StoreLocally(encMsg1,encMsg2)</text><polygon fill="#EC7211" points="271.3542,862.8581,260.9375,867.0247,271.3542,871.1914,267.1875,867.0247" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="265.1042" x2="499.4792" y1="867.0247" y2="867.0247"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="22.9167" x="282.8125" y="856.7851">Ack</text><rect fill="#4E5D6C" height="3.125" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" width="840.625" x="0" y="901.3835"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="840.625" y1="901.3835" y2="901.3835"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="840.625" y1="904.5085" y2="904.5085"/><rect fill="#4E5D6C" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:2.0833333333333335;" width="138.5417" x="351.0417" y="885.7747"/><text fill="#ABB6C2" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="109.375" x="362.5" y="906.7525">Test password</text><path d="M132.2917,936.7839 L279.1667,936.7839 L279.1667,953.418 L268.75,963.8346 L128.125,963.8346 L128.125,940.9505 A4.1667,4.1667 0 0 1 132.2917,936.7839 " fill="#FFFFFF" style="stroke:#4E5D6C;stroke-width:1.5625;"/><rect fill="none" height="193.5547" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="702.0833" x="128.125" y="936.7839"/><text fill="#0073BB" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="93.75" x="148.9583" y="954.6366">Precondition</text><path d="M138.5417,973.2096 L138.5417,999.2513 A4.1667,4.1667 0 0 0 142.7083,1003.418 L377.0833,1003.418 A4.1667,4.1667 0 0 0 381.25,999.2513 L381.25,979.4596 L370.8333,969.043 L142.7083,969.043 A4.1667,4.1667 0 0 0 138.5417,973.2096 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M370.8333,969.043 L370.8333,977.3763 A2.0833,2.0833 0 0 0 372.9167,979.4596 L381.25,979.4596 L370.8333,969.043 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="210.4167" x="150" y="991.0624">password : Attempted password</text><path d="M355.2083,1019.0104 L355.2083,1059.6354 A4.1667,4.1667 0 0 0 359.375,1063.8021 L641.6667,1063.8021 A4.1667,4.1667 0 0 0 645.8333,1059.6354 L645.8333,1025.2604 L635.4167,1014.8438 L359.375,1014.8438 A4.1667,4.1667 0 0 0 355.2083,1019.0104 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M635.4167,1014.8438 L635.4167,1023.1771 A2.0833,2.0833 0 0 0 637.5,1025.2604 L645.8333,1025.2604 L635.4167,1014.8438 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="170.8333" x="366.6667" y="1036.8632">encMsg1 : Encrypted Prize</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="258.3333" x="366.6667" y="1051.414">encMsg2 : Example encrypted message</text><path d="M498.9583,1079.362 L498.9583,1119.987 A4.1667,4.1667 0 0 0 503.125,1124.1536 L815.625,1124.1536 A4.1667,4.1667 0 0 0 819.7917,1119.987 L819.7917,1085.612 L809.375,1075.1953 L503.125,1075.1953 A4.1667,4.1667 0 0 0 498.9583,1079.362 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M809.375,1075.1953 L809.375,1083.5286 A2.0833,2.0833 0 0 0 811.4583,1085.612 L819.7917,1085.612 L809.375,1075.1953 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="134.375" x="510.4167" y="1097.2148">PRISMi : PRISM shard</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="137.5" x="648.9583" y="1097.2148">Calculated at sign up</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="288.5417" x="510.4167" y="1111.7655">exposedFlag : Boolean configuration setting</text><polygon fill="#EC7211" points="482.8125,1139.7135,493.2292,1143.8802,482.8125,1148.0469,486.9792,1143.8802" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="265.1042" x2="489.0625" y1="1143.8802" y2="1143.8802"/><polygon fill="#EC7211" points="276.5625,1179.2643,266.1458,1183.431,276.5625,1187.5977,272.3958,1183.431" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="270.3125" x2="499.4792" y1="1183.431" y2="1183.431"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="50" x="288.0208" y="1173.1913">encMsg</text><path d="M110.4167,1201.1393 L110.4167,1285.5143 A4.1667,4.1667 0 0 0 114.5833,1289.681 L404.1667,1289.681 A4.1667,4.1667 0 0 0 408.3333,1285.5143 L408.3333,1207.3893 L397.9167,1196.9727 L114.5833,1196.9727 A4.1667,4.1667 0 0 0 110.4167,1201.1393 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M397.9167,1196.9727 L397.9167,1205.306 A2.0833,2.0833 0 0 0 400,1207.3893 L408.3333,1207.3893 L397.9167,1196.9727 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="82.2917" x="121.875" y="1218.9921">r1 = random</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="256.25" x="121.875" y="1233.5429">Hash and convert password to EC point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="54.1667" x="121.875" y="1248.0937">gPass =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="207.2917" x="180.2083" y="1248.0937">findGPoint(hash(password))</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="105.2083" x="121.875" y="1262.6444">"Hide" the point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="79.1667" x="121.875" y="1277.1952">gBlurPass =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="72.9167" x="205.2083" y="1277.1952">gPass ⋅ r1</text><polygon fill="#EC7211" points="641.6667,1322.819,652.0833,1326.9857,641.6667,1331.1523,645.8333,1326.9857" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="265.1042" x2="647.9167" y1="1326.9857" y2="1326.9857"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="125" x="277.6042" y="1316.746">Convert(gBlurPass)</text><path d="M500,1344.694 L500,1414.4857 A4.1667,4.1667 0 0 0 504.1667,1418.6523 L814.5833,1418.6523 A4.1667,4.1667 0 0 0 818.75,1414.4857 L818.75,1350.944 L808.3333,1340.5273 L504.1667,1340.5273 A4.1667,4.1667 0 0 0 500,1344.694 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M808.3333,1340.5273 L808.3333,1348.8607 A2.0833,2.0833 0 0 0 810.4167,1350.944 L818.75,1350.944 L808.3333,1340.5273 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="103.125" x="511.4583" y="1362.5468">verify safe point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="87.5" x="511.4583" y="1377.0976">IsSafePoint =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="194.7917" x="603.125" y="1377.0976">testSafePoint( gBlurPass )</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="197.9167" x="511.4583" y="1391.6484">Test if IP needs to be throttled</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="275" x="511.4583" y="1406.1991">IsIPThrottled = Throttle(UserHostAddress)</text><path d="M495.8333,1432.0638 L568.75,1432.0638 L568.75,1448.6979 L558.3333,1459.1146 L491.6667,1459.1146 L491.6667,1436.2305 A4.1667,4.1667 0 0 1 495.8333,1432.0638 " fill="#FFFFFF" style="stroke:#4E5D6C;stroke-width:1.5625;"/><rect fill="none" height="300.5534" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="335.4167" x="491.6667" y="1432.0638"/><text fill="#0073BB" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="512.5" y="1449.9166">alt</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="589.5833" y="1450.9583">[</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="146.875" x="589.5833" y="1465.509">IsSafePoint == True</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="28.125" x="589.5833" y="1480.0598">and</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="175" x="589.5833" y="1494.6106">isIpThrottled == False ?</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="589.5833" y="1509.1614">]</text><path d="M512.5,1536.0352 L512.5,1576.6602 A4.1667,4.1667 0 0 0 516.6667,1580.8268 L802.0833,1580.8268 A4.1667,4.1667 0 0 0 806.25,1576.6602 L806.25,1542.2852 L795.8333,1531.8685 L516.6667,1531.8685 A4.1667,4.1667 0 0 0 512.5,1536.0352 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M795.8333,1531.8685 L795.8333,1540.2018 A2.0833,2.0833 0 0 0 797.9167,1542.2852 L806.25,1542.2852 L795.8333,1531.8685 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="221.875" x="523.9583" y="1553.8879">Apply the PRF on the hidden point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="120.8333" x="523.9583" y="1568.4387">gBlurPassPRISMi =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="136.4583" x="648.9583" y="1568.4387">gBlurPass ⋅ PRISMi</text><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="491.6667" x2="827.0833" y1="1588.0534" y2="1588.0534"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="502.0833" y="1604.8645">[</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="153.125" x="502.0833" y="1619.4153">IsSafePoint == False</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="15.625" x="502.0833" y="1633.9661">or</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="168.75" x="502.0833" y="1648.5168">isIpThrottled == True ?</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="502.0833" y="1663.0676">]</text><path d="M502.0833,1681.6406 L502.0833,1722.2656 A4.1667,4.1667 0 0 0 506.25,1726.4323 L812.5,1726.4323 A4.1667,4.1667 0 0 0 816.6667,1722.2656 L816.6667,1687.8906 L806.25,1677.474 L506.25,1677.474 A4.1667,4.1667 0 0 0 502.0833,1681.6406 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M806.25,1677.474 L806.25,1685.8073 A2.0833,2.0833 0 0 0 808.3333,1687.8906 L816.6667,1687.8906 L806.25,1677.474 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="198.9583" x="513.5417" y="1699.4934">Send pseudorandom response</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="120.8333" x="513.5417" y="1714.0442">gBlurPassPRISMi =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="157.2917" x="638.5417" y="1714.0442">gBlurPass ⋅ H(PRISMi)</text><path d="M517.7083,1747.2005 L590.625,1747.2005 L590.625,1763.8346 L580.2083,1774.2513 L513.5417,1774.2513 L513.5417,1751.3672 A4.1667,4.1667 0 0 1 517.7083,1747.2005 " fill="#FFFFFF" style="stroke:#4E5D6C;stroke-width:1.5625;"/><rect fill="none" height="173.7305" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="290.625" x="513.5417" y="1747.2005"/><text fill="#0073BB" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="534.375" y="1765.0533">alt</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="611.4583" y="1766.095">[</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="167.7083" x="611.4583" y="1780.6458">exposedFlag == True ?</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="611.4583" y="1795.1965">]</text><path d="M523.9583,1822.0703 L523.9583,1862.6953 A4.1667,4.1667 0 0 0 528.125,1866.862 L789.5833,1866.862 A4.1667,4.1667 0 0 0 793.75,1862.6953 L793.75,1828.3203 L783.3333,1817.9036 L528.125,1817.9036 A4.1667,4.1667 0 0 0 523.9583,1822.0703 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M783.3333,1817.9036 L783.3333,1826.237 A2.0833,2.0833 0 0 0 785.4167,1828.3203 L793.75,1828.3203 L783.3333,1817.9036 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="237.5" x="535.4167" y="1839.9231">if server exposed, send secret PRISM</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="84.375" x="535.4167" y="1854.4739">info = PRISMi</text><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="513.5417" x2="804.1667" y1="1874.0885" y2="1874.0885"/><path d="M610.4167,1884.5052 L610.4167,1910.5469 A4.1667,4.1667 0 0 0 614.5833,1914.7135 L704.1667,1914.7135 A4.1667,4.1667 0 0 0 708.3333,1910.5469 L708.3333,1890.7552 L697.9167,1880.3385 L614.5833,1880.3385 A4.1667,4.1667 0 0 0 610.4167,1884.5052 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M697.9167,1880.3385 L697.9167,1888.6719 A2.0833,2.0833 0 0 0 700,1890.7552 L708.3333,1890.7552 L697.9167,1880.3385 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="65.625" x="621.875" y="1902.358">info = null</text><polygon fill="#EC7211" points="276.5625,1955.2734,266.1458,1959.4401,276.5625,1963.6068,272.3958,1959.4401" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="270.3125" x2="658.3333" y1="1959.4401" y2="1959.4401"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="142.7083" x="288.0208" y="1949.2004">gBlurPassPRISMi , info</text><path d="M16.6667,1977.1484 L16.6667,2090.6901 A4.1667,4.1667 0 0 0 20.8333,2094.8568 L497.9167,2094.8568 A4.1667,4.1667 0 0 0 502.0833,2090.6901 L502.0833,1983.3984 L491.6667,1972.9818 L20.8333,1972.9818 A4.1667,4.1667 0 0 0 16.6667,1977.1484 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M491.6667,1972.9818 L491.6667,1981.3151 A2.0833,2.0833 0 0 0 493.75,1983.3984 L502.0833,1983.3984 L491.6667,1972.9818 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="92.7083" x="28.125" y="1995.0012">gPassPRISM =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="245.8333" x="125" y="1995.0012">∑ ( gBlurPassPRISMi ) ⋅ modInv(r1)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="4.1667" x="370.8333" y="1995.0012"> </text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="106.25" x="375" y="1995.0012">( gPass ⋅ PRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="208.3333" x="28.125" y="2009.552">PRISMKey = hash( gPassPRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="241.6667" x="28.125" y="2024.1028">Prize = aesDec_PRISMKey( encMsg1 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="317.7083" x="28.125" y="2038.6536">if Prize.decryptionSuccessful then Display( Prize )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="265.625" x="28.125" y="2053.2043">Example = aesDec_PRISMKey( encMsg2 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="365.625" x="28.125" y="2067.7551">if Example.decryptionSuccessful then Display( Example )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="209.375" x="28.125" y="2082.3059">if info != null then Display( info )</text><!--MD5=[d9a93145ce3d2773fa8b8f59662b7f1e]
@startuml H4x2_Challenge
title H4X Challenge 1
!include https://raw.githubusercontent.com/bschwarz/puml-themes/master/themes/aws-orange-light/puml-theme-aws-orange-light.puml

actor Consumer as "User"
participant "WWW" as hOrk
collections "Nodes" as mORKx

== Set up password ==

Consumer->hOrk: 
activate hOrk
activate Consumer

hOrk- ->Consumer
deactivate hOrk

note over Consumer
    password1 = GeneratePassword()
    password2 = "AAA"
    r1 = random
    r2 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass1 = **findGPoint(hash(password1))**
    gPass2 = **findGPoint(hash(password2))**
    //<color orange>"Hide" the points with a random"</color>//
    gBlurPass1 = **gPass1 ⋅ r1**
    gBlurPass2 = **gPass2 ⋅ r2**
    exposedFlag1 = True
    exposedFlag1 = False
end note

Consumer->mORKx: Setup(gBlurPass1,gBlurPass2,exposedFlag)
activate mORKx

note over mORKx
    PRISMi = random
    //<color orange>Apply the PRF on the hidden point</color>//
    gBlurPassPRISM1i = **gBlurPass1 ⋅ PRISMi**
    gBlurPassPRISM2i = **gBlurPass2 ⋅ PRISMi**
    StoreLocally(PRISMi,exposedFlag)
end note 

mORKx- ->Consumer: gBlurPassPRISM1i , gBlurPassPRISM2i
deactivate mORKx

note over Consumer
    gPassPRISM1 = **∑ ( gBlurPassPRISM1i ) ⋅ modInv(r1)** //<color orange>( gPass1 ⋅ PRISM )</color>//
    gPassPRISM2 = **∑ ( gBlurPassPRISM2i ) ⋅ modInv(r2)** //<color orange>( gPass2 ⋅ PRISM )</color>//
    PRISMKey1 = hash( gPassPRISM1 )
    PRISMKey2 = hash( gPassPRISM1 )
    encMsg1 = aesEnc_PRISMKey1( "Congrats! Your prize is xxxxxxxx" )
    encMsg2 = aesEnc_PRISMKey2( "This is an example message" )
end note

Consumer->hOrk: StoreMsgs(encMsg1,encMsg2)
activate hOrk
note over hOrk: StoreLocally(encMsg1,encMsg2)
hOrk- ->Consumer: Ack
deactivate hOrk
deactivate Consumer

== Test password ==

group Precondition
note over Consumer
    password : Attempted password
end note 

note over hOrk
    encMsg1 : Encrypted Prize
    encMsg2 : Example encrypted message
end note 

note over mORKx
    PRISMi : PRISM shard //<color orange>Calculated at sign up</color>//
    exposedFlag : Boolean configuration setting
end note

end

Consumer->hOrk
activate hOrk
activate Consumer

hOrk- ->Consumer: encMsg
deactivate hOrk

note over Consumer
    r1 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass = **findGPoint(hash(password))**
    //<color orange>"Hide" the point</color>//
    gBlurPass = **gPass ⋅ r1**
end note

Consumer->mORKx: Convert(gBlurPass)
activate mORKx

note over mORKx
    //<color orange>verify safe point</color>//
    IsSafePoint = **testSafePoint( gBlurPass )**
    //<color orange>Test if IP needs to be throttled</color>//
    IsIPThrottled = Throttle(UserHostAddress)
end note 

alt \nIsSafePoint == True \nand\nisIpThrottled == False ?\n
    note over mORKx
        //<color orange>Apply the PRF on the hidden point</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ PRISMi**
    end note
else \nIsSafePoint == False \nor\nisIpThrottled == True ?\n
    note over mORKx
        //<color orange>Send pseudorandom response</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ H(PRISMi)**
    end note
end

alt \nexposedFlag == True ?\n
    note over mORKx
        //<color orange>if server exposed, send secret PRISM</color>//
        info = PRISMi
    end note
else
    note over mORKx
        info = null
    end note
end

mORKx- ->Consumer: gBlurPassPRISMi , info
deactivate mORKx

note over Consumer
    gPassPRISM = **∑ ( gBlurPassPRISMi ) ⋅ modInv(r1)** //<color orange>( gPass ⋅ PRISM )</color>//
    PRISMKey = hash( gPassPRISM )
    Prize = aesDec_PRISMKey( encMsg1 )
    if Prize.decryptionSuccessful then Display( Prize )
    Example = aesDec_PRISMKey( encMsg2 )
    if Example.decryptionSuccessful then Display( Example )
    if info != null then Display( info )
end note

@enduml

@startuml H4x2_Challenge
title H4X Challenge 1



skinparam backgroundColor transparent










skinparam defaultFontName       "Verdana"
skinparam defaultFontSize       12
skinparam dpi                   100
skinparam shadowing             false
skinparam roundcorner           8
skinparam ParticipantPadding    40
skinparam BoxPadding            40
skinparam Padding               5
skinparam ArrowColor            #4E5D6C
skinparam stereotype {
    CBackgroundColor #ffffff
    CBorderColor #cccccc
    ABackgroundColor #4a9a35
    ABorderColor #176702
    IBackgroundColor #da5b41
    IBorderColor #a7280e
    EBackgroundColor #f08e41
    EBorderColor #bd5b0e
    NBackgroundColor #338fc9
    NBorderColor #005c96
}
skinparam title {
	FontColor	                 #4E5D6C
	BorderColor	                 #FFFFFF
	FontSize	    	         20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor              #FFFFFF-#cccccc
}

skinparam legend {
	BackgroundColor #FFFFFF
	BorderColor #cccccc
	FontColor #abb6c2
}

skinparam swimlane {
	BorderColor #0073bb
	BorderThickness 2
	TitleBackgroundColor  #FFFFFF-#cccccc
	TitleFontColor #EC7211
}


skinparam activity {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	BarColor #1D8102
	StartColor #0073bb
	EndColor #0073bb
	DiamondBackgroundColor #ffffff
  	DiamondBorderColor #cccccc
  	DiamondFontColor #4E5D6C
}

skinparam participant {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	ParticipantBorderThickness 2
}

skinparam actor {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam arrow {
	Thickness 3
	Color #EC7211
	FontColor #4E5D6C
}

skinparam sequence {
	ArrowThickness 3
	BorderColor #EC7211
	TitleFontColor #EC7211
	BackgroundColor transparent
	StartColor #EC7211
	EndColor #EC7211
	BoxBackgroundColor transparent
	BoxBorderColor #4E5D6C
	BoxFontColor #4E5D6C
	DelayFontColor #4E5D6C
	LifeLineBorderColor #abb6c2
	LifeLineBorderThickness 2
	LifeLineBackgroundColor #bcc5ce
	GroupBorderColor #4E5D6C
	GroupFontColor #4E5D6C
	GroupHeaderFontColor #0073bb
	GroupBackgroundColor #FFFFFF
	GroupBodyBackgroundColor transparent
	GroupHeaderBackgroundColor transparent
	DividerBackgroundColor #4E5D6C
    DividerBorderColor #4E5D6C
    DividerBorderThickness 2
    DividerFontColor #abb6c2
	ReferenceBackgroundColor transparent
	ReferenceBorderColor #4E5D6C
	ReferenceFontColor #4E5D6C
	ReferenceHeaderFontColor #0073bb
	ReferenceHeaderBackgroundColor #FFFFFF
	StereotypeFontColor #FFF
}

skinparam partition {
	BorderColor #EC7211
	FontColor #EC7211
	BackgroundColor transparent
}

skinparam collections {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam control {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam entity {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam boundary {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam agent {
	BackgroundColor #EC7211
	BorderColor #f08e41
	FontColor #4E5D6C
}

skinparam note {
	BorderThickness 1
	BackgroundColor #0073bb
	BorderColor #005c96
	FontColor #FFF
}

skinparam artifact {
	BackgroundColor #4E5D6C
	BorderColor #717d89
	FontColor #abb6c2
}

skinparam component {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam interface {
	BackgroundColor  #a7280e
	BorderColor  #d13212
	FontColor #4E5D6C
}

skinparam storage {
	BackgroundColor #EC7211
  	BorderColor #bd5b0e
	FontColor #FFF
}

skinparam node {
	BackgroundColor  transparent
	BorderColor #abb6c2
	FontColor #abb6c2
}

skinparam cloud {
	BackgroundColor transparent
	BorderColor #4E5D6C
	FontColor #abb6c2
}

skinparam database {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam class {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	HeaderBackgroundColor #f08e41
	StereotypeFontColor #4E5D6C
	BorderThickness 1
	AttributeFontColor #FFF
	AttributeFontSize 11
}

skinparam object {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	StereotypeFontColor #4E5D6C
	BorderThickness 1
	AttributeFontColor #FFF
	AttributeFontSize 11
}

skinparam usecase {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	BorderThickness 2
	StereotypeFontColor #EC7211
}

skinparam rectangle {
	BackgroundColor transparent
	FontColor #4E5D6C
	BorderColor #4E5D6C
	BorderThickness 2
	StereotypeFontColor #abb6c2
}

skinparam package {
	BackgroundColor #FFFFFF
  	BorderColor #4E5D6C
	FontColor #4E5D6C
	BorderThickness 2
}

skinparam folder {
	BackgroundColor #ffffff
  	BorderColor #EC7211
	FontColor #EC7211
	BorderThickness 2
}

skinparam frame {
	BackgroundColor #ffffff
  	BorderColor #0073bb
	FontColor #0073bb
	BorderThickness 2
}

skinparam state {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	StartColor #0073bb
	EndColor #0073bb
	AttributeFontColor #4E5D6C
	AttributeFontSize 11
}

skinparam queue {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam card {
	BackgroundColor #0073bb
	BorderColor #005c96
	FontColor #FFF
}

skinparam file {
	BackgroundColor #cccccc
	BorderColor #abb6c2
	FontColor #4E5D6C
}


skinparam stack {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}


actor Consumer as "User"
participant "WWW" as hOrk
collections "Nodes" as mORKx

== Set up password ==

Consumer->hOrk: 
activate hOrk
activate Consumer

hOrk- ->Consumer
deactivate hOrk

note over Consumer
    password1 = GeneratePassword()
    password2 = "AAA"
    r1 = random
    r2 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass1 = **findGPoint(hash(password1))**
    gPass2 = **findGPoint(hash(password2))**
    //<color orange>"Hide" the points with a random"</color>//
    gBlurPass1 = **gPass1 ⋅ r1**
    gBlurPass2 = **gPass2 ⋅ r2**
    exposedFlag1 = True
    exposedFlag1 = False
end note

Consumer->mORKx: Setup(gBlurPass1,gBlurPass2,exposedFlag)
activate mORKx

note over mORKx
    PRISMi = random
    //<color orange>Apply the PRF on the hidden point</color>//
    gBlurPassPRISM1i = **gBlurPass1 ⋅ PRISMi**
    gBlurPassPRISM2i = **gBlurPass2 ⋅ PRISMi**
    StoreLocally(PRISMi,exposedFlag)
end note 

mORKx- ->Consumer: gBlurPassPRISM1i , gBlurPassPRISM2i
deactivate mORKx

note over Consumer
    gPassPRISM1 = **∑ ( gBlurPassPRISM1i ) ⋅ modInv(r1)** //<color orange>( gPass1 ⋅ PRISM )</color>//
    gPassPRISM2 = **∑ ( gBlurPassPRISM2i ) ⋅ modInv(r2)** //<color orange>( gPass2 ⋅ PRISM )</color>//
    PRISMKey1 = hash( gPassPRISM1 )
    PRISMKey2 = hash( gPassPRISM1 )
    encMsg1 = aesEnc_PRISMKey1( "Congrats! Your prize is xxxxxxxx" )
    encMsg2 = aesEnc_PRISMKey2( "This is an example message" )
end note

Consumer->hOrk: StoreMsgs(encMsg1,encMsg2)
activate hOrk
note over hOrk: StoreLocally(encMsg1,encMsg2)
hOrk- ->Consumer: Ack
deactivate hOrk
deactivate Consumer

== Test password ==

group Precondition
note over Consumer
    password : Attempted password
end note 

note over hOrk
    encMsg1 : Encrypted Prize
    encMsg2 : Example encrypted message
end note 

note over mORKx
    PRISMi : PRISM shard //<color orange>Calculated at sign up</color>//
    exposedFlag : Boolean configuration setting
end note

end

Consumer->hOrk
activate hOrk
activate Consumer

hOrk- ->Consumer: encMsg
deactivate hOrk

note over Consumer
    r1 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass = **findGPoint(hash(password))**
    //<color orange>"Hide" the point</color>//
    gBlurPass = **gPass ⋅ r1**
end note

Consumer->mORKx: Convert(gBlurPass)
activate mORKx

note over mORKx
    //<color orange>verify safe point</color>//
    IsSafePoint = **testSafePoint( gBlurPass )**
    //<color orange>Test if IP needs to be throttled</color>//
    IsIPThrottled = Throttle(UserHostAddress)
end note 

alt \nIsSafePoint == True \nand\nisIpThrottled == False ?\n
    note over mORKx
        //<color orange>Apply the PRF on the hidden point</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ PRISMi**
    end note
else \nIsSafePoint == False \nor\nisIpThrottled == True ?\n
    note over mORKx
        //<color orange>Send pseudorandom response</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ H(PRISMi)**
    end note
end

alt \nexposedFlag == True ?\n
    note over mORKx
        //<color orange>if server exposed, send secret PRISM</color>//
        info = PRISMi
    end note
else
    note over mORKx
        info = null
    end note
end

mORKx- ->Consumer: gBlurPassPRISMi , info
deactivate mORKx

note over Consumer
    gPassPRISM = **∑ ( gBlurPassPRISMi ) ⋅ modInv(r1)** //<color orange>( gPass ⋅ PRISM )</color>//
    PRISMKey = hash( gPassPRISM )
    Prize = aesDec_PRISMKey( encMsg1 )
    if Prize.decryptionSuccessful then Display( Prize )
    Example = aesDec_PRISMKey( encMsg2 )
    if Example.decryptionSuccessful then Display( Example )
    if info != null then Display( info )
end note

@enduml

PlantUML version 1.2022.13(Sat Nov 19 13:22:17 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>