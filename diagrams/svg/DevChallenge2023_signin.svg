<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2203.125px" preserveAspectRatio="none" style="width:837px;height:2203px;" version="1.1" viewBox="0 0 837 2203" width="837.5px" zoomAndPan="magnify"><defs><linearGradient id="g4wubvo11j6qj0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#CCCCCC"/></linearGradient><linearGradient id="g4wubvo11j6qj1" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#F08E41"/><stop offset="100%" stop-color="#EC7211"/></linearGradient></defs><g><rect fill="url(#g4wubvo11j6qj0)" height="45.0846" id="_title" rx="4.1667" ry="4.1667" style="stroke:#FFFFFF;stroke-width:1.0416666666666667;" width="311.4583" x="258.8542" y="10.4167"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="20.8333" font-weight="bold" lengthAdjust="spacing" textLength="290.625" x="269.2708" y="40.1713">Dev Challenge flowchart</text><rect fill="#BCC5CE" height="647.0052" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="239.0625" y="220.0195"/><rect fill="#BCC5CE" height="958.0404" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="239.0625" y="1143.8802"/><rect fill="#BCC5CE" height="14.5833" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="479.6875" y="220.0195"/><rect fill="#BCC5CE" height="85.3516" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="479.6875" y="781.6732"/><rect fill="#BCC5CE" height="39.5508" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="479.6875" y="1143.8802"/><rect fill="#BCC5CE" height="143.5547" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="632.8125" y="480.013"/><rect fill="#BCC5CE" height="632.4544" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="632.8125" y="1326.9857"/><rect fill="none" height="193.5547" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="707.2917" x="112.5" y="936.7839"/><rect fill="none" height="300.5534" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="361.4583" x="457.2917" y="1432.0638"/><rect fill="none" height="173.7305" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="290.625" x="492.7083" y="1747.2005"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="243.75" x2="243.75" y1="149.2188" y2="2111.2956"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="484.375" x2="484.375" y1="149.2188" y2="2111.2956"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="637.5" x2="637.5" y1="149.2188" y2="2111.2956"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="226.0417" y="141.0624">User</text><ellipse cx="244.2708" cy="70.6055" fill="url(#g4wubvo11j6qj1)" rx="8.3333" ry="8.3333" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><path d="M244.2708,78.9388 L244.2708,107.0638 M230.7292,87.2721 L257.8125,87.2721 M244.2708,107.0638 L230.7292,122.6888 M244.2708,107.0638 L257.8125,122.6888 " fill="none" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="226.0417" y="2127.065">User</text><ellipse cx="244.2708" cy="2144.0755" fill="url(#g4wubvo11j6qj1)" rx="8.3333" ry="8.3333" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><path d="M244.2708,2152.4089 L244.2708,2180.5339 M230.7292,2160.7422 L257.8125,2160.7422 M244.2708,2180.5339 L230.7292,2196.1589 M244.2708,2180.5339 L257.8125,2196.1589 " fill="none" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><rect fill="url(#g4wubvo11j6qj1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="59.375" x="455.2083" y="108.6263"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="34.375" x="467.7083" y="132.7291">WWW</text><rect fill="url(#g4wubvo11j6qj1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="59.375" x="455.2083" y="2110.2539"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="34.375" x="467.7083" y="2134.3567">WWW</text><rect fill="url(#g4wubvo11j6qj1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="59.375" x="608.3333" y="108.6263"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="34.375" x="620.8333" y="132.7291">Node</text><rect fill="url(#g4wubvo11j6qj1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="59.375" x="608.3333" y="2110.2539"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="34.375" x="620.8333" y="2134.3567">Node</text><rect fill="#BCC5CE" height="647.0052" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="239.0625" y="220.0195"/><rect fill="#BCC5CE" height="958.0404" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="239.0625" y="1143.8802"/><rect fill="#BCC5CE" height="14.5833" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="479.6875" y="220.0195"/><rect fill="#BCC5CE" height="85.3516" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="479.6875" y="781.6732"/><rect fill="#BCC5CE" height="39.5508" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="479.6875" y="1143.8802"/><rect fill="#BCC5CE" height="143.5547" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="632.8125" y="480.013"/><rect fill="#BCC5CE" height="632.4544" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="632.8125" y="1326.9857"/><rect fill="#4E5D6C" height="3.125" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" width="830.2083" x="0" y="185.6608"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="830.2083" y1="185.6608" y2="185.6608"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="830.2083" y1="188.7858" y2="188.7858"/><rect fill="#4E5D6C" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:2.0833333333333335;" width="154.1667" x="338.0208" y="170.0521"/><text fill="#ABB6C2" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="125" x="349.4792" y="191.0299">Set up password</text><polygon fill="#EC7211" points="467.1875,215.8529,477.6042,220.0195,467.1875,224.1862,471.3542,220.0195" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="249.4792" x2="473.4375" y1="220.0195" y2="220.0195"/><polygon fill="#EC7211" points="260.9375,230.4362,250.5208,234.6029,260.9375,238.7695,256.7708,234.6029" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="254.6875" x2="483.8542" y1="234.6029" y2="234.6029"/><path d="M100,252.3112 L100,438.7695 A4.1667,4.1667 0 0 0 104.1667,442.9362 L384.375,442.9362 A4.1667,4.1667 0 0 0 388.5417,438.7695 L388.5417,258.5612 L378.125,248.1445 L104.1667,248.1445 A4.1667,4.1667 0 0 0 100,252.3112 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M378.125,248.1445 L378.125,256.4779 A2.0833,2.0833 0 0 0 380.2083,258.5612 L388.5417,258.5612 L378.125,248.1445 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="223.9583" x="111.4583" y="270.164">password1 = GeneratePassword()</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="125" x="111.4583" y="284.7148">password2 = "AAA"</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="82.2917" x="111.4583" y="299.2655">r1 = random</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="82.2917" x="111.4583" y="313.8163">r2 = random</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="256.25" x="111.4583" y="328.3671">Hash and convert password to EC point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="62.5" x="111.4583" y="342.9179">gPass1 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="175" x="178.125" y="342.9179">hash2Point(password1)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="62.5" x="111.4583" y="357.4687">gPass2 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="175" x="178.125" y="357.4687">hash2Point(password2)</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="215.625" x="111.4583" y="372.0194">"Hide" the points with a random"</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="87.5" x="111.4583" y="386.5702">gBlurPass1 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="81.25" x="203.125" y="386.5702">gPass1 ⋅ r1</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="87.5" x="111.4583" y="401.121">gBlurPass2 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="81.25" x="203.125" y="401.121">gPass2 ⋅ r2</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="138.5417" x="111.4583" y="415.6718">exposedFlag1 = True</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="143.75" x="111.4583" y="430.2226">exposedFlag1 = False</text><polygon fill="#EC7211" points="620.3125,475.8464,630.7292,480.013,620.3125,484.1797,624.4792,480.013" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="249.4792" x2="626.5625" y1="480.013" y2="480.013"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="285.4167" x="261.9792" y="469.7734">Setup(gBlurPass1,gBlurPass2,exposedFlag)</text><path d="M482.2917,497.7214 L482.2917,582.0964 A4.1667,4.1667 0 0 0 486.4583,586.263 L788.5417,586.263 A4.1667,4.1667 0 0 0 792.7083,582.0964 L792.7083,503.9714 L782.2917,493.5547 L486.4583,493.5547 A4.1667,4.1667 0 0 0 482.2917,497.7214 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M782.2917,493.5547 L782.2917,501.888 A2.0833,2.0833 0 0 0 784.375,503.9714 L792.7083,503.9714 L782.2917,493.5547 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="110.4167" x="493.75" y="515.5741">PRISMi = random</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="221.875" x="493.75" y="530.1249">Apply the PRF on the hidden point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="129.1667" x="493.75" y="544.6757">gBlurPassPRISM1i =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="144.7917" x="627.0833" y="544.6757">gBlurPass1 ⋅ PRISMi</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="129.1667" x="493.75" y="559.2265">gBlurPassPRISM2i =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="144.7917" x="627.0833" y="559.2265">gBlurPass2 ⋅ PRISMi</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="216.6667" x="493.75" y="573.7773">StoreLocally(PRISMi,exposedFlag)</text><polygon fill="#EC7211" points="260.9375,619.401,250.5208,623.5677,260.9375,627.7344,256.7708,623.5677" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="254.6875" x2="636.9792" y1="623.5677" y2="623.5677"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="241.6667" x="272.3958" y="613.328">gBlurPassPRISM1i , gBlurPassPRISM2i</text><path d="M5.2083,641.276 L5.2083,740.2344 A4.1667,4.1667 0 0 0 9.375,744.401 L479.1667,744.401 A4.1667,4.1667 0 0 0 483.3333,740.2344 L483.3333,647.526 L472.9167,637.1094 L9.375,637.1094 A4.1667,4.1667 0 0 0 5.2083,641.276 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M472.9167,637.1094 L472.9167,645.4427 A2.0833,2.0833 0 0 0 475,647.526 L483.3333,647.526 L472.9167,637.1094 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="101.0417" x="16.6667" y="659.1288">gPassPRISM1 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="221.875" x="121.875" y="659.1288">gBlurPassPRISM1i ⋅ modInv(r1)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="4.1667" x="343.75" y="659.1288"> </text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="114.5833" x="347.9167" y="659.1288">( gPass1 ⋅ PRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="101.0417" x="16.6667" y="673.6796">gPassPRISM2 =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="221.875" x="121.875" y="673.6796">gBlurPassPRISM2i ⋅ modInv(r2)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="4.1667" x="343.75" y="673.6796"> </text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="114.5833" x="347.9167" y="673.6796">( gPass2 ⋅ PRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="225" x="16.6667" y="688.2304">PRISMKey1 = hash( gPassPRISM1 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="225" x="16.6667" y="702.7812">PRISMKey2 = hash( gPassPRISM1 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="430.2083" x="16.6667" y="717.3319">encMsg1 = aesEnc_PRISMKey1( "Congrats! Your prize is xxxxxxxx" )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="412.5" x="16.6667" y="731.8827">encMsg2 = aesEnc_PRISMKey2( "This is an example message" )</text><polygon fill="#EC7211" points="467.1875,777.5065,477.6042,781.6732,467.1875,785.8398,471.3542,781.6732" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="249.4792" x2="473.4375" y1="781.6732" y2="781.6732"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="200" x="261.9792" y="771.4335">StoreMsgs(encMsg1,encMsg2)</text><path d="M363.5417,799.3815 L363.5417,825.4232 A4.1667,4.1667 0 0 0 367.7083,829.5898 L601.0417,829.5898 A4.1667,4.1667 0 0 0 605.2083,825.4232 L605.2083,805.6315 L594.7917,795.2148 L367.7083,795.2148 A4.1667,4.1667 0 0 0 363.5417,799.3815 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M594.7917,795.2148 L594.7917,803.5482 A2.0833,2.0833 0 0 0 596.875,805.6315 L605.2083,805.6315 L594.7917,795.2148 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="209.375" x="375" y="817.2343">StoreLocally(encMsg1,encMsg2)</text><polygon fill="#EC7211" points="255.7292,862.8581,245.3125,867.0247,255.7292,871.1914,251.5625,867.0247" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="249.4792" x2="483.8542" y1="867.0247" y2="867.0247"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="22.9167" x="267.1875" y="856.7851">Ack</text><rect fill="#4E5D6C" height="3.125" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" width="830.2083" x="0" y="901.3835"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="830.2083" y1="901.3835" y2="901.3835"/><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;" x1="0" x2="830.2083" y1="904.5085" y2="904.5085"/><rect fill="#4E5D6C" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:2.0833333333333335;" width="138.5417" x="345.8333" y="885.7747"/><text fill="#ABB6C2" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="109.375" x="357.2917" y="906.7525">Test password</text><path d="M116.6667,936.7839 L263.5417,936.7839 L263.5417,953.418 L253.125,963.8346 L112.5,963.8346 L112.5,940.9505 A4.1667,4.1667 0 0 1 116.6667,936.7839 " fill="#FFFFFF" style="stroke:#4E5D6C;stroke-width:1.5625;"/><rect fill="none" height="193.5547" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="707.2917" x="112.5" y="936.7839"/><text fill="#0073BB" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="93.75" x="133.3333" y="954.6366">Precondition</text><path d="M122.9167,973.2096 L122.9167,999.2513 A4.1667,4.1667 0 0 0 127.0833,1003.418 L361.4583,1003.418 A4.1667,4.1667 0 0 0 365.625,999.2513 L365.625,979.4596 L355.2083,969.043 L127.0833,969.043 A4.1667,4.1667 0 0 0 122.9167,973.2096 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M355.2083,969.043 L355.2083,977.3763 A2.0833,2.0833 0 0 0 357.2917,979.4596 L365.625,979.4596 L355.2083,969.043 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="210.4167" x="134.375" y="991.0624">password : Attempted password</text><path d="M339.5833,1019.0104 L339.5833,1059.6354 A4.1667,4.1667 0 0 0 343.75,1063.8021 L626.0417,1063.8021 A4.1667,4.1667 0 0 0 630.2083,1059.6354 L630.2083,1025.2604 L619.7917,1014.8438 L343.75,1014.8438 A4.1667,4.1667 0 0 0 339.5833,1019.0104 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M619.7917,1014.8438 L619.7917,1023.1771 A2.0833,2.0833 0 0 0 621.875,1025.2604 L630.2083,1025.2604 L619.7917,1014.8438 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="170.8333" x="351.0417" y="1036.8632">encMsg1 : Encrypted Prize</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="258.3333" x="351.0417" y="1051.414">encMsg2 : Example encrypted message</text><path d="M466.6667,1079.362 L466.6667,1119.987 A4.1667,4.1667 0 0 0 470.8333,1124.1536 L805.2083,1124.1536 A4.1667,4.1667 0 0 0 809.375,1119.987 L809.375,1085.612 L798.9583,1075.1953 L470.8333,1075.1953 A4.1667,4.1667 0 0 0 466.6667,1079.362 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M798.9583,1075.1953 L798.9583,1083.5286 A2.0833,2.0833 0 0 0 801.0417,1085.612 L809.375,1085.612 L798.9583,1075.1953 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="168.75" x="478.125" y="1097.2148">PRISMi : PRISM augmentor</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="137.5" x="651.0417" y="1097.2148">Calculated at sign up</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="288.5417" x="478.125" y="1111.7655">exposedFlag : Boolean configuration setting</text><polygon fill="#EC7211" points="467.1875,1139.7135,477.6042,1143.8802,467.1875,1148.0469,471.3542,1143.8802" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="249.4792" x2="473.4375" y1="1143.8802" y2="1143.8802"/><polygon fill="#EC7211" points="260.9375,1179.2643,250.5208,1183.431,260.9375,1187.5977,256.7708,1183.431" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="254.6875" x2="483.8542" y1="1183.431" y2="1183.431"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="50" x="272.3958" y="1173.1913">encMsg</text><path d="M100,1201.1393 L100,1285.5143 A4.1667,4.1667 0 0 0 104.1667,1289.681 L384.375,1289.681 A4.1667,4.1667 0 0 0 388.5417,1285.5143 L388.5417,1207.3893 L378.125,1196.9727 L104.1667,1196.9727 A4.1667,4.1667 0 0 0 100,1201.1393 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M378.125,1196.9727 L378.125,1205.306 A2.0833,2.0833 0 0 0 380.2083,1207.3893 L388.5417,1207.3893 L378.125,1196.9727 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="82.2917" x="111.4583" y="1218.9921">r1 = random</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="256.25" x="111.4583" y="1233.5429">Hash and convert password to EC point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="54.1667" x="111.4583" y="1248.0937">gPass =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="166.6667" x="169.7917" y="1248.0937">hash2Point(password)</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="105.2083" x="111.4583" y="1262.6444">"Hide" the point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="79.1667" x="111.4583" y="1277.1952">gBlurPass =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="72.9167" x="194.7917" y="1277.1952">gPass ⋅ r1</text><polygon fill="#EC7211" points="620.3125,1322.819,630.7292,1326.9857,620.3125,1331.1523,624.4792,1326.9857" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="249.4792" x2="626.5625" y1="1326.9857" y2="1326.9857"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="125" x="261.9792" y="1316.746">Convert(gBlurPass)</text><path d="M478.125,1344.694 L478.125,1414.4857 A4.1667,4.1667 0 0 0 482.2917,1418.6523 L792.7083,1418.6523 A4.1667,4.1667 0 0 0 796.875,1414.4857 L796.875,1350.944 L786.4583,1340.5273 L482.2917,1340.5273 A4.1667,4.1667 0 0 0 478.125,1344.694 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M786.4583,1340.5273 L786.4583,1348.8607 A2.0833,2.0833 0 0 0 788.5417,1350.944 L796.875,1350.944 L786.4583,1340.5273 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="103.125" x="489.5833" y="1362.5468">verify safe point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="87.5" x="489.5833" y="1377.0976">IsSafePoint =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="194.7917" x="581.25" y="1377.0976">testSafePoint( gBlurPass )</text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="197.9167" x="489.5833" y="1391.6484">Test if IP needs to be throttled</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="275" x="489.5833" y="1406.1991">IsIPThrottled = Throttle(UserHostAddress)</text><path d="M461.4583,1432.0638 L534.375,1432.0638 L534.375,1448.6979 L523.9583,1459.1146 L457.2917,1459.1146 L457.2917,1436.2305 A4.1667,4.1667 0 0 1 461.4583,1432.0638 " fill="#FFFFFF" style="stroke:#4E5D6C;stroke-width:1.5625;"/><rect fill="none" height="300.5534" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="361.4583" x="457.2917" y="1432.0638"/><text fill="#0073BB" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="478.125" y="1449.9166">alt</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="555.2083" y="1450.9583">[</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="146.875" x="555.2083" y="1465.509">IsSafePoint == True</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="28.125" x="555.2083" y="1480.0598">and</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="175" x="555.2083" y="1494.6106">isIpThrottled == False ?</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="555.2083" y="1509.1614">]</text><path d="M490.625,1536.0352 L490.625,1576.6602 A4.1667,4.1667 0 0 0 494.7917,1580.8268 L780.2083,1580.8268 A4.1667,4.1667 0 0 0 784.375,1576.6602 L784.375,1542.2852 L773.9583,1531.8685 L494.7917,1531.8685 A4.1667,4.1667 0 0 0 490.625,1536.0352 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M773.9583,1531.8685 L773.9583,1540.2018 A2.0833,2.0833 0 0 0 776.0417,1542.2852 L784.375,1542.2852 L773.9583,1531.8685 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="221.875" x="502.0833" y="1553.8879">Apply the PRF on the hidden point</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="120.8333" x="502.0833" y="1568.4387">gBlurPassPRISMi =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="136.4583" x="627.0833" y="1568.4387">gBlurPass ⋅ PRISMi</text><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="457.2917" x2="818.75" y1="1588.0534" y2="1588.0534"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="467.7083" y="1604.8645">[</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="153.125" x="467.7083" y="1619.4153">IsSafePoint == False</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="15.625" x="467.7083" y="1633.9661">or</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="168.75" x="467.7083" y="1648.5168">isIpThrottled == True ?</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="467.7083" y="1663.0676">]</text><path d="M467.7083,1681.6406 L467.7083,1722.2656 A4.1667,4.1667 0 0 0 471.875,1726.4323 L804.1667,1726.4323 A4.1667,4.1667 0 0 0 808.3333,1722.2656 L808.3333,1687.8906 L797.9167,1677.474 L471.875,1677.474 A4.1667,4.1667 0 0 0 467.7083,1681.6406 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M797.9167,1677.474 L797.9167,1685.8073 A2.0833,2.0833 0 0 0 800,1687.8906 L808.3333,1687.8906 L797.9167,1677.474 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="198.9583" x="479.1667" y="1699.4934">Send pseudorandom response</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="120.8333" x="479.1667" y="1714.0442">gBlurPassPRISMi =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="183.3333" x="604.1667" y="1714.0442">gBlurPass ⋅ hash(PRISMi)</text><path d="M496.875,1747.2005 L569.7917,1747.2005 L569.7917,1763.8346 L559.375,1774.2513 L492.7083,1774.2513 L492.7083,1751.3672 A4.1667,4.1667 0 0 1 496.875,1747.2005 " fill="#FFFFFF" style="stroke:#4E5D6C;stroke-width:1.5625;"/><rect fill="none" height="173.7305" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="290.625" x="492.7083" y="1747.2005"/><text fill="#0073BB" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="513.5417" y="1765.0533">alt</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="590.625" y="1766.095">[</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="167.7083" x="590.625" y="1780.6458">exposedFlag == True ?</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="590.625" y="1795.1965">]</text><path d="M503.125,1822.0703 L503.125,1862.6953 A4.1667,4.1667 0 0 0 507.2917,1866.862 L768.75,1866.862 A4.1667,4.1667 0 0 0 772.9167,1862.6953 L772.9167,1828.3203 L762.5,1817.9036 L507.2917,1817.9036 A4.1667,4.1667 0 0 0 503.125,1822.0703 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M762.5,1817.9036 L762.5,1826.237 A2.0833,2.0833 0 0 0 764.5833,1828.3203 L772.9167,1828.3203 L762.5,1817.9036 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="237.5" x="514.5833" y="1839.9231">if server exposed, send secret PRISM</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="84.375" x="514.5833" y="1854.4739">info = PRISMi</text><line style="stroke:#4E5D6C;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="492.7083" x2="783.3333" y1="1874.0885" y2="1874.0885"/><path d="M588.5417,1884.5052 L588.5417,1910.5469 A4.1667,4.1667 0 0 0 592.7083,1914.7135 L682.2917,1914.7135 A4.1667,4.1667 0 0 0 686.4583,1910.5469 L686.4583,1890.7552 L676.0417,1880.3385 L592.7083,1880.3385 A4.1667,4.1667 0 0 0 588.5417,1884.5052 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M676.0417,1880.3385 L676.0417,1888.6719 A2.0833,2.0833 0 0 0 678.125,1890.7552 L686.4583,1890.7552 L676.0417,1880.3385 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="65.625" x="600" y="1902.358">info = null</text><polygon fill="#EC7211" points="260.9375,1955.2734,250.5208,1959.4401,260.9375,1963.6068,256.7708,1959.4401" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="254.6875" x2="636.9792" y1="1959.4401" y2="1959.4401"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="142.7083" x="272.3958" y="1949.2004">gBlurPassPRISMi , info</text><path d="M17.7083,1977.1484 L17.7083,2090.6901 A4.1667,4.1667 0 0 0 21.875,2094.8568 L466.6667,2094.8568 A4.1667,4.1667 0 0 0 470.8333,2090.6901 L470.8333,1983.3984 L460.4167,1972.9818 L21.875,1972.9818 A4.1667,4.1667 0 0 0 17.7083,1977.1484 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M460.4167,1972.9818 L460.4167,1981.3151 A2.0833,2.0833 0 0 0 462.5,1983.3984 L470.8333,1983.3984 L460.4167,1972.9818 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="92.7083" x="29.1667" y="1995.0012">gPassPRISM =</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="213.5417" x="126.0417" y="1995.0012">gBlurPassPRISMi ⋅ modInv(r1)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="4.1667" x="339.5833" y="1995.0012"> </text><text fill="#FFA500" font-family="&quot;Verdana&quot;" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="106.25" x="343.75" y="1995.0012">( gPass ⋅ PRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="208.3333" x="29.1667" y="2009.552">PRISMKey = hash( gPassPRISM )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="241.6667" x="29.1667" y="2024.1028">Prize = aesDec_PRISMKey( encMsg1 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="317.7083" x="29.1667" y="2038.6536">if Prize.decryptionSuccessful then Display( Prize )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="265.625" x="29.1667" y="2053.2043">Example = aesDec_PRISMKey( encMsg2 )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="365.625" x="29.1667" y="2067.7551">if Example.decryptionSuccessful then Display( Example )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="209.375" x="29.1667" y="2082.3059">if info != null then Display( info )</text><!--MD5=[ecac1370308cfc81a86f9091479b78c3]
@startuml DevChallenge2023_signin
title Dev Challenge flowchart
!include https://raw.githubusercontent.com/bschwarz/puml-themes/master/themes/aws-orange-light/puml-theme-aws-orange-light.puml

actor Consumer as "User"
participant "WWW" as hOrk
participant "Node" as mORKx

== Set up password ==

Consumer->hOrk: 
activate hOrk
activate Consumer

hOrk- ->Consumer
deactivate hOrk

note over Consumer
    password1 = GeneratePassword()
    password2 = "AAA"
    r1 = random
    r2 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass1 = **hash2Point(password1)**
    gPass2 = **hash2Point(password2)**
    //<color orange>"Hide" the points with a random"</color>//
    gBlurPass1 = **gPass1 ⋅ r1**
    gBlurPass2 = **gPass2 ⋅ r2**
    exposedFlag1 = True
    exposedFlag1 = False
end note

Consumer->mORKx: Setup(gBlurPass1,gBlurPass2,exposedFlag)
activate mORKx

note over mORKx
    PRISMi = random
    //<color orange>Apply the PRF on the hidden point</color>//
    gBlurPassPRISM1i = **gBlurPass1 ⋅ PRISMi**
    gBlurPassPRISM2i = **gBlurPass2 ⋅ PRISMi**
    StoreLocally(PRISMi,exposedFlag)
end note 

mORKx- ->Consumer: gBlurPassPRISM1i , gBlurPassPRISM2i
deactivate mORKx

note over Consumer
    gPassPRISM1 = **gBlurPassPRISM1i ⋅ modInv(r1)** //<color orange>( gPass1 ⋅ PRISM )</color>//
    gPassPRISM2 = **gBlurPassPRISM2i ⋅ modInv(r2)** //<color orange>( gPass2 ⋅ PRISM )</color>//
    PRISMKey1 = hash( gPassPRISM1 )
    PRISMKey2 = hash( gPassPRISM1 )
    encMsg1 = aesEnc_PRISMKey1( "Congrats! Your prize is xxxxxxxx" )
    encMsg2 = aesEnc_PRISMKey2( "This is an example message" )
end note

Consumer->hOrk: StoreMsgs(encMsg1,encMsg2)
activate hOrk
note over hOrk: StoreLocally(encMsg1,encMsg2)
hOrk- ->Consumer: Ack
deactivate hOrk
deactivate Consumer

== Test password ==

group Precondition
note over Consumer
    password : Attempted password
end note 

note over hOrk
    encMsg1 : Encrypted Prize
    encMsg2 : Example encrypted message
end note 

note over mORKx
    PRISMi : PRISM augmentor //<color orange>Calculated at sign up</color>//
    exposedFlag : Boolean configuration setting
end note

end

Consumer->hOrk
activate hOrk
activate Consumer

hOrk- ->Consumer: encMsg
deactivate hOrk

note over Consumer
    r1 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass = **hash2Point(password)**
    //<color orange>"Hide" the point</color>//
    gBlurPass = **gPass ⋅ r1**
end note

Consumer->mORKx: Convert(gBlurPass)
activate mORKx

note over mORKx
    //<color orange>verify safe point</color>//
    IsSafePoint = **testSafePoint( gBlurPass )**
    //<color orange>Test if IP needs to be throttled</color>//
    IsIPThrottled = Throttle(UserHostAddress)
end note 

alt \nIsSafePoint == True \nand\nisIpThrottled == False ?\n
    note over mORKx
        //<color orange>Apply the PRF on the hidden point</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ PRISMi**
    end note
else \nIsSafePoint == False \nor\nisIpThrottled == True ?\n
    note over mORKx
        //<color orange>Send pseudorandom response</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ hash(PRISMi)**
    end note
end

alt \nexposedFlag == True ?\n
    note over mORKx
        //<color orange>if server exposed, send secret PRISM</color>//
        info = PRISMi
    end note
else
    note over mORKx
        info = null
    end note
end

mORKx- ->Consumer: gBlurPassPRISMi , info
deactivate mORKx

note over Consumer
    gPassPRISM = **gBlurPassPRISMi ⋅ modInv(r1)** //<color orange>( gPass ⋅ PRISM )</color>//
    PRISMKey = hash( gPassPRISM )
    Prize = aesDec_PRISMKey( encMsg1 )
    if Prize.decryptionSuccessful then Display( Prize )
    Example = aesDec_PRISMKey( encMsg2 )
    if Example.decryptionSuccessful then Display( Example )
    if info != null then Display( info )
end note

@enduml

@startuml DevChallenge2023_signin
title Dev Challenge flowchart



skinparam backgroundColor transparent










skinparam defaultFontName       "Verdana"
skinparam defaultFontSize       12
skinparam dpi                   100
skinparam shadowing             false
skinparam roundcorner           8
skinparam ParticipantPadding    40
skinparam BoxPadding            40
skinparam Padding               5
skinparam ArrowColor            #4E5D6C
skinparam stereotype {
    CBackgroundColor #ffffff
    CBorderColor #cccccc
    ABackgroundColor #4a9a35
    ABorderColor #176702
    IBackgroundColor #da5b41
    IBorderColor #a7280e
    EBackgroundColor #f08e41
    EBorderColor #bd5b0e
    NBackgroundColor #338fc9
    NBorderColor #005c96
}
skinparam title {
	FontColor	                 #4E5D6C
	BorderColor	                 #FFFFFF
	FontSize	    	         20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor              #FFFFFF-#cccccc
}

skinparam legend {
	BackgroundColor #FFFFFF
	BorderColor #cccccc
	FontColor #abb6c2
}

skinparam swimlane {
	BorderColor #0073bb
	BorderThickness 2
	TitleBackgroundColor  #FFFFFF-#cccccc
	TitleFontColor #EC7211
}


skinparam activity {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	BarColor #1D8102
	StartColor #0073bb
	EndColor #0073bb
	DiamondBackgroundColor #ffffff
  	DiamondBorderColor #cccccc
  	DiamondFontColor #4E5D6C
}

skinparam participant {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	ParticipantBorderThickness 2
}

skinparam actor {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam arrow {
	Thickness 3
	Color #EC7211
	FontColor #4E5D6C
}

skinparam sequence {
	ArrowThickness 3
	BorderColor #EC7211
	TitleFontColor #EC7211
	BackgroundColor transparent
	StartColor #EC7211
	EndColor #EC7211
	BoxBackgroundColor transparent
	BoxBorderColor #4E5D6C
	BoxFontColor #4E5D6C
	DelayFontColor #4E5D6C
	LifeLineBorderColor #abb6c2
	LifeLineBorderThickness 2
	LifeLineBackgroundColor #bcc5ce
	GroupBorderColor #4E5D6C
	GroupFontColor #4E5D6C
	GroupHeaderFontColor #0073bb
	GroupBackgroundColor #FFFFFF
	GroupBodyBackgroundColor transparent
	GroupHeaderBackgroundColor transparent
	DividerBackgroundColor #4E5D6C
    DividerBorderColor #4E5D6C
    DividerBorderThickness 2
    DividerFontColor #abb6c2
	ReferenceBackgroundColor transparent
	ReferenceBorderColor #4E5D6C
	ReferenceFontColor #4E5D6C
	ReferenceHeaderFontColor #0073bb
	ReferenceHeaderBackgroundColor #FFFFFF
	StereotypeFontColor #FFF
}

skinparam partition {
	BorderColor #EC7211
	FontColor #EC7211
	BackgroundColor transparent
}

skinparam collections {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam control {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam entity {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam boundary {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam agent {
	BackgroundColor #EC7211
	BorderColor #f08e41
	FontColor #4E5D6C
}

skinparam note {
	BorderThickness 1
	BackgroundColor #0073bb
	BorderColor #005c96
	FontColor #FFF
}

skinparam artifact {
	BackgroundColor #4E5D6C
	BorderColor #717d89
	FontColor #abb6c2
}

skinparam component {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam interface {
	BackgroundColor  #a7280e
	BorderColor  #d13212
	FontColor #4E5D6C
}

skinparam storage {
	BackgroundColor #EC7211
  	BorderColor #bd5b0e
	FontColor #FFF
}

skinparam node {
	BackgroundColor  transparent
	BorderColor #abb6c2
	FontColor #abb6c2
}

skinparam cloud {
	BackgroundColor transparent
	BorderColor #4E5D6C
	FontColor #abb6c2
}

skinparam database {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam class {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	HeaderBackgroundColor #f08e41
	StereotypeFontColor #4E5D6C
	BorderThickness 1
	AttributeFontColor #FFF
	AttributeFontSize 11
}

skinparam object {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	StereotypeFontColor #4E5D6C
	BorderThickness 1
	AttributeFontColor #FFF
	AttributeFontSize 11
}

skinparam usecase {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	BorderThickness 2
	StereotypeFontColor #EC7211
}

skinparam rectangle {
	BackgroundColor transparent
	FontColor #4E5D6C
	BorderColor #4E5D6C
	BorderThickness 2
	StereotypeFontColor #abb6c2
}

skinparam package {
	BackgroundColor #FFFFFF
  	BorderColor #4E5D6C
	FontColor #4E5D6C
	BorderThickness 2
}

skinparam folder {
	BackgroundColor #ffffff
  	BorderColor #EC7211
	FontColor #EC7211
	BorderThickness 2
}

skinparam frame {
	BackgroundColor #ffffff
  	BorderColor #0073bb
	FontColor #0073bb
	BorderThickness 2
}

skinparam state {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	StartColor #0073bb
	EndColor #0073bb
	AttributeFontColor #4E5D6C
	AttributeFontSize 11
}

skinparam queue {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam card {
	BackgroundColor #0073bb
	BorderColor #005c96
	FontColor #FFF
}

skinparam file {
	BackgroundColor #cccccc
	BorderColor #abb6c2
	FontColor #4E5D6C
}


skinparam stack {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}


actor Consumer as "User"
participant "WWW" as hOrk
participant "Node" as mORKx

== Set up password ==

Consumer->hOrk: 
activate hOrk
activate Consumer

hOrk- ->Consumer
deactivate hOrk

note over Consumer
    password1 = GeneratePassword()
    password2 = "AAA"
    r1 = random
    r2 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass1 = **hash2Point(password1)**
    gPass2 = **hash2Point(password2)**
    //<color orange>"Hide" the points with a random"</color>//
    gBlurPass1 = **gPass1 ⋅ r1**
    gBlurPass2 = **gPass2 ⋅ r2**
    exposedFlag1 = True
    exposedFlag1 = False
end note

Consumer->mORKx: Setup(gBlurPass1,gBlurPass2,exposedFlag)
activate mORKx

note over mORKx
    PRISMi = random
    //<color orange>Apply the PRF on the hidden point</color>//
    gBlurPassPRISM1i = **gBlurPass1 ⋅ PRISMi**
    gBlurPassPRISM2i = **gBlurPass2 ⋅ PRISMi**
    StoreLocally(PRISMi,exposedFlag)
end note 

mORKx- ->Consumer: gBlurPassPRISM1i , gBlurPassPRISM2i
deactivate mORKx

note over Consumer
    gPassPRISM1 = **gBlurPassPRISM1i ⋅ modInv(r1)** //<color orange>( gPass1 ⋅ PRISM )</color>//
    gPassPRISM2 = **gBlurPassPRISM2i ⋅ modInv(r2)** //<color orange>( gPass2 ⋅ PRISM )</color>//
    PRISMKey1 = hash( gPassPRISM1 )
    PRISMKey2 = hash( gPassPRISM1 )
    encMsg1 = aesEnc_PRISMKey1( "Congrats! Your prize is xxxxxxxx" )
    encMsg2 = aesEnc_PRISMKey2( "This is an example message" )
end note

Consumer->hOrk: StoreMsgs(encMsg1,encMsg2)
activate hOrk
note over hOrk: StoreLocally(encMsg1,encMsg2)
hOrk- ->Consumer: Ack
deactivate hOrk
deactivate Consumer

== Test password ==

group Precondition
note over Consumer
    password : Attempted password
end note 

note over hOrk
    encMsg1 : Encrypted Prize
    encMsg2 : Example encrypted message
end note 

note over mORKx
    PRISMi : PRISM augmentor //<color orange>Calculated at sign up</color>//
    exposedFlag : Boolean configuration setting
end note

end

Consumer->hOrk
activate hOrk
activate Consumer

hOrk- ->Consumer: encMsg
deactivate hOrk

note over Consumer
    r1 = random
    //<color orange>Hash and convert password to EC point</color>//
    gPass = **hash2Point(password)**
    //<color orange>"Hide" the point</color>//
    gBlurPass = **gPass ⋅ r1**
end note

Consumer->mORKx: Convert(gBlurPass)
activate mORKx

note over mORKx
    //<color orange>verify safe point</color>//
    IsSafePoint = **testSafePoint( gBlurPass )**
    //<color orange>Test if IP needs to be throttled</color>//
    IsIPThrottled = Throttle(UserHostAddress)
end note 

alt \nIsSafePoint == True \nand\nisIpThrottled == False ?\n
    note over mORKx
        //<color orange>Apply the PRF on the hidden point</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ PRISMi**
    end note
else \nIsSafePoint == False \nor\nisIpThrottled == True ?\n
    note over mORKx
        //<color orange>Send pseudorandom response</color>//
        gBlurPassPRISMi = **gBlurPass ⋅ hash(PRISMi)**
    end note
end

alt \nexposedFlag == True ?\n
    note over mORKx
        //<color orange>if server exposed, send secret PRISM</color>//
        info = PRISMi
    end note
else
    note over mORKx
        info = null
    end note
end

mORKx- ->Consumer: gBlurPassPRISMi , info
deactivate mORKx

note over Consumer
    gPassPRISM = **gBlurPassPRISMi ⋅ modInv(r1)** //<color orange>( gPass ⋅ PRISM )</color>//
    PRISMKey = hash( gPassPRISM )
    Prize = aesDec_PRISMKey( encMsg1 )
    if Prize.decryptionSuccessful then Display( Prize )
    Example = aesDec_PRISMKey( encMsg2 )
    if Example.decryptionSuccessful then Display( Example )
    if info != null then Display( info )
end note

@enduml

PlantUML version 1.2022.13(Sat Nov 19 13:22:17 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>